/**
 *
 * carbon-angular v0.0.0 | context-menu.component.js
 *
 * Copyright 2014, 2022 IBM
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0

 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


import { Component, ElementRef, HostListener, Input } from "@angular/core";
var ContextMenuComponent = /** @class */ (function () {
    function ContextMenuComponent(elementRef) {
        this.elementRef = elementRef;
        this.root = true;
        this.open = false;
        this.position = {
            left: 0,
            top: 0
        };
    }
    ContextMenuComponent.prototype.ngOnChanges = function (changes) {
        if (changes.open && changes.open.currentValue) {
            this.focusMenu();
        }
    };
    ContextMenuComponent.prototype.focusMenu = function () {
        var _this = this;
        // wait until the next tick to let the DOM settle before changing the focus
        var list = this.elementRef.nativeElement.querySelector("ul");
        setTimeout(function () {
            if (_this.root) {
                list.focus();
            }
            else {
                var firstOption = list.querySelector(".bx--context-menu-option, .bx--menu-option");
                firstOption.focus();
            }
        });
    };
    ContextMenuComponent.prototype.handleNavigation = function (event) {
        var list = this.elementRef.nativeElement.querySelector("ul");
        var subMenus = Array.from(list.querySelectorAll("ul[role=menu]"));
        var menuItems = Array.from(list.querySelectorAll(".bx--context-menu-option, .bx--menu-option"))
            .filter(function (menuItem) { return !subMenus.some(function (subMenu) { return subMenu.contains(menuItem); }); });
        var currentIndex = menuItems.findIndex(function (menuItem) { return parseInt(menuItem.getAttribute("tabindex"), 10) === 0; });
        var currentMenuItem = menuItems[currentIndex];
        switch (event.key) {
            case "ArrowDown": {
                if (document.activeElement === list) {
                    menuItems[0].focus();
                }
                else {
                    if (currentIndex !== -1 && currentIndex < menuItems.length - 1) {
                        menuItems[currentIndex + 1].focus();
                    }
                }
                break;
            }
            case "ArrowUp": {
                if (document.activeElement === list) {
                    menuItems[menuItems.length - 1].focus();
                }
                else {
                    if (currentIndex !== -1 && currentIndex > 0) {
                        menuItems[currentIndex - 1].focus();
                    }
                }
                break;
            }
            case "ArrowRight": {
                if (currentIndex !== -1 && subMenus.some(function (subMenu) { return currentMenuItem.contains(subMenu); })) {
                    currentMenuItem.click();
                }
                break;
            }
            case "ArrowLeft": {
                var parent_1 = currentMenuItem.parentElement.closest(".bx--context-menu-option, .bx--menu-option");
                if (parent_1) {
                    parent_1.focus();
                }
                break;
            }
        }
    };
    ContextMenuComponent.prototype.getDimensions = function () {
        var element = this.elementRef.nativeElement.querySelector("ul");
        return element.getBoundingClientRect();
    };
    ContextMenuComponent.decorators = [
        { type: Component, args: [{
                    selector: "ibm-context-menu",
                    template: "\n\t\t<ul\n\t\t\tclass=\"bx--context-menu bx--menu\"\n\t\t\t[ngClass]=\"{\n\t\t\t\t'bx--context-menu--root': root,\n\t\t\t\t'bx--menu--root': root,\n\t\t\t\t'bx--context-menu--open': open,\n\t\t\t\t'bx--menu--open': open\n\t\t\t}\"\n\t\t\trole=\"menu\"\n\t\t\ttabindex=\"-1\"\n\t\t\t[ngStyle]=\"{\n\t\t\t\t'left.px': position.left,\n\t\t\t\t'top.px': position.top\n\t\t\t}\">\n\t\t\t<ng-content></ng-content>\n\t\t</ul>\n\t"
                }] }
    ];
    /** @nocollapse */
    ContextMenuComponent.ctorParameters = function () { return [
        { type: ElementRef }
    ]; };
    ContextMenuComponent.propDecorators = {
        root: [{ type: Input }],
        open: [{ type: Input }],
        position: [{ type: Input }],
        handleNavigation: [{ type: HostListener, args: ["keydown", ["$event"],] }]
    };
    return ContextMenuComponent;
}());
export { ContextMenuComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGV4dC1tZW51LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL2NhcmJvbi1jb21wb25lbnRzLWFuZ3VsYXIvY29udGV4dC1tZW51LyIsInNvdXJjZXMiOlsiY29udGV4dC1tZW51LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQ04sU0FBUyxFQUNULFVBQVUsRUFDVixZQUFZLEVBQ1osS0FBSyxFQUdMLE1BQU0sZUFBZSxDQUFDO0FBRXZCO0lBNkJDLDhCQUFzQixVQUFzQjtRQUF0QixlQUFVLEdBQVYsVUFBVSxDQUFZO1FBUG5DLFNBQUksR0FBRyxJQUFJLENBQUM7UUFDWixTQUFJLEdBQUcsS0FBSyxDQUFDO1FBQ2IsYUFBUSxHQUFHO1lBQ25CLElBQUksRUFBRSxDQUFDO1lBQ1AsR0FBRyxFQUFFLENBQUM7U0FDTixDQUFDO0lBRThDLENBQUM7SUFFakQsMENBQVcsR0FBWCxVQUFZLE9BQXNCO1FBQ2pDLElBQUksT0FBTyxDQUFDLElBQUksSUFBSSxPQUFPLENBQUMsSUFBSSxDQUFDLFlBQVksRUFBRTtZQUM5QyxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7U0FDakI7SUFDRixDQUFDO0lBRUQsd0NBQVMsR0FBVDtRQUFBLGlCQVdDO1FBVkEsMkVBQTJFO1FBQzNFLElBQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQWdCLENBQUM7UUFDOUUsVUFBVSxDQUFDO1lBQ1YsSUFBSSxLQUFJLENBQUMsSUFBSSxFQUFFO2dCQUNkLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQzthQUNiO2lCQUFNO2dCQUNOLElBQU0sV0FBVyxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsNENBQTRDLENBQWdCLENBQUM7Z0JBQ3BHLFdBQVcsQ0FBQyxLQUFLLEVBQUUsQ0FBQzthQUNwQjtRQUNGLENBQUMsQ0FBQyxDQUFDO0lBQ0osQ0FBQztJQUdELCtDQUFnQixH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RUFBRSx5YUFpQlQ7aUJBQ0Q7Ozs7Z0JBM0JBLFVBQVU7Ozt1QkE2QlQsS0FBSzt1QkFDTCxLQUFLOzJCQUNMLEtBQUs7bUNBMEJMLFlBQVksU0FBQyxTQUFTLEVBQUUsQ0FBQyxRQUFRLENBQUM7O0lBb0RwQywyQkFBQztDQUFBLEFBdEdELElBc0dDO1NBakZZLG9CQUFvQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG5cdENvbXBvbmVudCxcblx0RWxlbWVudFJlZixcblx0SG9zdExpc3RlbmVyLFxuXHRJbnB1dCxcblx0U2ltcGxlQ2hhbmdlcyxcblx0T25DaGFuZ2VzXG59IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5cbkBDb21wb25lbnQoe1xuXHRzZWxlY3RvcjogXCJpYm0tY29udGV4dC1tZW51XCIsXG5cdHRlbXBsYXRlOiBgXG5cdFx0PHVsXG5cdFx0XHRjbGFzcz1cImJ4LS1jb250ZXh0LW1lbnUgYngtLW1lbnVcIlxuXHRcdFx0W25nQ2xhc3NdPVwie1xuXHRcdFx0XHQnYngtLWNvbnRleHQtbWVudS0tcm9vdCc6IHJvb3QsXG5cdFx0XHRcdCdieC0tbWVudS0tcm9vdCc6IHJvb3QsXG5cdFx0XHRcdCdieC0tY29udGV4dC1tZW51LS1vcGVuJzogb3Blbixcblx0XHRcdFx0J2J4LS1tZW51LS1vcGVuJzogb3BlblxuXHRcdFx0fVwiXG5cdFx0XHRyb2xlPVwibWVudVwiXG5cdFx0XHR0YWJpbmRleD1cIi0xXCJcblx0XHRcdFtuZ1N0eWxlXT1cIntcblx0XHRcdFx0J2xlZnQucHgnOiBwb3NpdGlvbi5sZWZ0LFxuXHRcdFx0XHQndG9wLnB4JzogcG9zaXRpb24udG9wXG5cdFx0XHR9XCI+XG5cdFx0XHQ8bmctY29udGVudD48L25nLWNvbnRlbnQ+XG5cdFx0PC91bD5cblx0YFxufSlcbmV4cG9ydCBjbGFzcyBDb250ZXh0TWVudUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uQ2hhbmdlcyB7XG5cdEBJbnB1dCgpIHJvb3QgPSB0cnVlO1xuXHRASW5wdXQoKSBvcGVuID0gZmFsc2U7XG5cdEBJbnB1dCgpIHBvc2l0aW9uID0ge1xuXHRcdGxlZnQ6IDAsXG5cdFx0dG9wOiAwXG5cdH07XG5cblx0Y29uc3RydWN0b3IocHJvdGVjdGVkIGVsZW1lbnRSZWY6IEVsZW1lbnRSZWYpIHsgfVxuXG5cdG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcblx0XHRpZiAoY2hhbmdlcy5vcGVuICYmIGNoYW5nZXMub3Blbi5jdXJyZW50VmFsdWUpIHtcblx0XHRcdHRoaXMuZm9jdXNNZW51KCk7XG5cdFx0fVxuXHR9XG5cblx0Zm9jdXNNZW51KCkge1xuXHRcdC8vIHdhaXQgdW50aWwgdGhlIG5leHQgdGljayB0byBsZXQgdGhlIERPTSBzZXR0bGUgYmVmb3JlIGNoYW5naW5nIHRoZSBmb2N1c1xuXHRcdGNvbnN0IGxpc3QgPSB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwidWxcIikgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRpZiAodGhpcy5yb290KSB7XG5cdFx0XHRcdGxpc3QuZm9jdXMoKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnN0IGZpcnN0T3B0aW9uID0gbGlzdC5xdWVyeVNlbGVjdG9yKFwiLmJ4LS1jb250ZXh0LW1lbnUtb3B0aW9uLCAuYngtLW1lbnUtb3B0aW9uXCIpIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0XHRmaXJzdE9wdGlvbi5mb2N1cygpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0QEhvc3RMaXN0ZW5lcihcImtleWRvd25cIiwgW1wiJGV2ZW50XCJdKVxuXHRoYW5kbGVOYXZpZ2F0aW9uKGV2ZW50OiBLZXlib2FyZEV2ZW50KSB7XG5cdFx0Y29uc3QgbGlzdDogSFRNTEVsZW1lbnQgPSB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwidWxcIik7XG5cdFx0Y29uc3Qgc3ViTWVudXM6IEhUTUxFbGVtZW50W10gPSBBcnJheS5mcm9tKGxpc3QucXVlcnlTZWxlY3RvckFsbChcInVsW3JvbGU9bWVudV1cIikpO1xuXHRcdGNvbnN0IG1lbnVJdGVtczogSFRNTEVsZW1lbnRbXSA9IChcblx0XHRcdEFycmF5LmZyb20obGlzdC5xdWVyeVNlbGVjdG9yQWxsKFwiLmJ4LS1jb250ZXh0LW1lbnUtb3B0aW9uLCAuYngtLW1lbnUtb3B0aW9uXCIpKSBhcyBIVE1MRWxlbWVudFtdKVxuXHRcdFx0LmZpbHRlcihtZW51SXRlbSA9PiAhc3ViTWVudXMuc29tZShzdWJNZW51ID0+IHN1Yk1lbnUuY29udGFpbnMobWVudUl0ZW0pKVxuXHRcdCk7XG5cdFx0Y29uc3QgY3VycmVudEluZGV4ID0gbWVudUl0ZW1zLmZpbmRJbmRleChtZW51SXRlbSA9PiBwYXJzZUludChtZW51SXRlbS5nZXRBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiKSwgMTApID09PSAwKTtcblx0XHRjb25zdCBjdXJyZW50TWVudUl0ZW0gPSBtZW51SXRlbXNbY3VycmVudEluZGV4XTtcblxuXHRcdHN3aXRjaCAoZXZlbnQua2V5KSB7XG5cdFx0XHRjYXNlIFwiQXJyb3dEb3duXCI6IHtcblx0XHRcdFx0aWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT09IGxpc3QpIHtcblx0XHRcdFx0XHRtZW51SXRlbXNbMF0uZm9jdXMoKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpZiAoY3VycmVudEluZGV4ICE9PSAtMSAmJiBjdXJyZW50SW5kZXggPCBtZW51SXRlbXMubGVuZ3RoIC0gMSkge1xuXHRcdFx0XHRcdFx0bWVudUl0ZW1zW2N1cnJlbnRJbmRleCArIDFdLmZvY3VzKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdFx0Y2FzZSBcIkFycm93VXBcIjoge1xuXHRcdFx0XHRpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gbGlzdCkge1xuXHRcdFx0XHRcdG1lbnVJdGVtc1ttZW51SXRlbXMubGVuZ3RoIC0gMV0uZm9jdXMoKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpZiAoY3VycmVudEluZGV4ICE9PSAtMSAmJiBjdXJyZW50SW5kZXggPiAwKSB7XG5cdFx0XHRcdFx0XHRtZW51SXRlbXNbY3VycmVudEluZGV4IC0gMV0uZm9jdXMoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0XHRjYXNlIFwiQXJyb3dSaWdodFwiOiB7XG5cdFx0XHRcdGlmIChjdXJyZW50SW5kZXggIT09IC0xICYmIHN1Yk1lbnVzLnNvbWUoc3ViTWVudSA9PiBjdXJyZW50TWVudUl0ZW0uY29udGFpbnMoc3ViTWVudSkpKSB7XG5cdFx0XHRcdFx0Y3VycmVudE1lbnVJdGVtLmNsaWNrKCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0XHRjYXNlIFwiQXJyb3dMZWZ0XCI6IHtcblx0XHRcdFx0Y29uc3QgcGFyZW50ID0gY3VycmVudE1lbnVJdGVtLnBhcmVudEVsZW1lbnQuY2xvc2VzdChcIi5ieC0tY29udGV4dC1tZW51LW9wdGlvbiwgLmJ4LS1tZW51LW9wdGlvblwiKSBhcyBIVE1MRWxlbWVudDtcblx0XHRcdFx0aWYgKHBhcmVudCkge1xuXHRcdFx0XHRcdHBhcmVudC5mb2N1cygpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGdldERpbWVuc2lvbnMoKSB7XG5cdFx0Y29uc3QgZWxlbWVudDogSFRNTEVsZW1lbnQgPSB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwidWxcIik7XG5cdFx0cmV0dXJuIGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdH1cbn1cbiJdfQ==