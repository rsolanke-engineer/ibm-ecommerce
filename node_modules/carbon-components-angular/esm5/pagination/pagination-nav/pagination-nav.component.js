/**
 *
 * carbon-angular v0.0.0 | pagination-nav.component.js
 *
 * Copyright 2014, 2022 IBM
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0

 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


import { PaginationModel } from "../pagination-model.class";
import { Component, Input, Output, EventEmitter } from "@angular/core";
import { I18n } from "carbon-components-angular/i18n";
import { ExperimentalService } from "carbon-components-angular/experimental";
import { merge } from "carbon-components-angular/utils";
import { range } from "carbon-components-angular/common";
/**
 * Use pagination when you have multiple pages of data to handle.
 *
 * [See demo](../../?path=/story/components-pagination-nav--basic)
 *
 * ```html
 * <ibm-pagination-nav [model]="model" (selectPage)="selectPage($event)"></ibm-pagination-nav>
 * ```
 *
 * In your `selectPage()` method set the `model.currentPage` to selected page, _after_
 * you load the page.
 *
 * ```typescript
 * selectPage(page) {
 * 	// ... your code to load the page goes here
 *
 * 	this.model.currentPage = page;
 *
 * 	// ... anything you want to do after page selection changes goes here
 * }
 * ```
 *
 * <example-url>../../iframe.html?id=components-pagination-nav--basic</example-url>
 */
var PaginationNav = /** @class */ (function () {
    function PaginationNav(i18n, experimental) {
        this.i18n = i18n;
        this.experimental = experimental;
        /**
         * Set to `true` to disable the backward/forward buttons.
         */
        this.disabled = false;
        /**
         * Number of items to show in pagination. Minimum is 4.
         */
        this.numOfItemsToShow = 4;
        /**
         * Emits the new page number.
         *
         * You should tie into this and update `model.currentPage` once the fresh
         * data is finally loaded.
         */
        this.selectPage = new EventEmitter();
        this.nextItemText = this.i18n.getOverridable("PAGINATION.NEXT");
        this.previousItemText = this.i18n.getOverridable("PAGINATION.PREVIOUS");
        PaginationNav.paginationCounter++;
    }
    Object.defineProperty(PaginationNav.prototype, "translations", {
        /**
         * Expects an object that contains some or all of:
         * ```
         * {
         *		"NEXT": "Next",
         *		"PREVIOUS": "Previous",
         * }
         * ```
         */
        set: function (value) {
            var valueWithDefaults = merge(this.i18n.getMultiple("PAGINATION"), value);
            this.nextItemText.override(valueWithDefaults.NEXT);
            this.previousItemText.override(valueWithDefaults.PREVIOUS);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PaginationNav.prototype, "totalNumbersArray", {
        get: function () {
            return range(this.totalDataLength + 1, 1);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PaginationNav.prototype, "currentPage", {
        get: function () {
            return this.model.currentPage;
        },
        set: function (value) {
            value = Number(value);
            // emits the value to allow the user to update current page
            // in the model once the page is loaded
            this.selectPage.emit(value);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PaginationNav.prototype, "totalDataLength", {
        get: function () {
            return this.model.totalDataLength;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PaginationNav.prototype, "startOffset", {
        get: function () {
            return this.numOfItemsToShow <= 4 && this.currentPage > 1 ? 0 : 1;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PaginationNav.prototype, "frontCuts", {
        get: function () {
            var cuts = this.getCuts();
            return cuts.front;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PaginationNav.prototype, "backCuts", {
        get: function () {
            var cuts = this.getCuts();
            return cuts.back;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PaginationNav.prototype, "leftArrowDisabled", {
        get: function () {
            return this.disabled || this.currentPage === 1;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PaginationNav.prototype, "rightArrowDisabled", {
        get: function () {
            return this.disabled || this.currentPage === this.totalDataLength;
        },
        enumerable: true,
        configurable: true
    });
    PaginationNav.prototype.handleOverflowSelection = function (page) {
        if (typeof page === "number") {
            this.currentPage = page;
        }
    };
    PaginationNav.prototype.jumpToNext = function () {
        this.currentPage = this.currentPage < this.totalDataLength ? this.currentPage + 1 : this.totalDataLength;
    };
    PaginationNav.prototype.jumpToPrevious = function () {
        this.currentPage = this.currentPage > 1 ? this.currentPage - 1 : 1;
    };
    PaginationNav.prototype.getPages = function () {
        if (this.totalDataLength <= 1) {
            return null;
        }
        var cuts = this.getCuts();
        return this.totalNumbersArray.slice(this.startOffset + cuts.front, (1 + cuts.back) * -1);
    };
    PaginationNav.prototype.getCuts = function (splitPoint) {
        if (splitPoint === void 0) { splitPoint = null; }
        var page = this.currentPage - 1;
        var totalItems = this.totalDataLength;
        var itemsThatFit = this.numOfItemsToShow;
        if (itemsThatFit >= totalItems) {
            return {
                front: 0,
                back: 0
            };
        }
        var split = splitPoint || Math.ceil(itemsThatFit / 2) - 1;
        var frontHidden = page + 1 - split;
        var backHidden = totalItems - page - (itemsThatFit - split) + 1;
        if (frontHidden <= 1) {
            backHidden -= frontHidden <= 0 ? Math.abs(frontHidden) + 1 : 0;
            frontHidden = 0;
        }
        if (backHidden <= 1) {
            frontHidden -= backHidden <= 0 ? Math.abs(backHidden) + 1 : 0;
            backHidden = 0;
        }
        return {
            front: frontHidden,
            back: backHidden
        };
    };
    PaginationNav.paginationCounter = 0;
    PaginationNav.decorators = [
        { type: Component, args: [{
                    selector: "ibm-pagination-nav",
                    template: "\n\t<div>\n\t\t<div class=\"bx--pagination-nav\">\n\t\t\t<ul class=\"bx--pagination-nav__list\">\n\t\t\t\t<li class=\"bx--pagination-nav__list-item\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"bx--btn bx--btn--ghost bx--pagination-nav-previous\n\t\t\t\t\t\tbx--btn--icon-only bx--tooltip__trigger bx--tooltip--a11y bx--tooltip--bottom bx--tooltip--align-center\"\n\t\t\t\t\t\t[disabled]=\"leftArrowDisabled\"\n\t\t\t\t\t\t(click)=\"jumpToPrevious()\">\n\t\t\t\t\t\t<span class=\"bx--assistive-text\">{{previousItemText.subject | async}}</span>\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\tibmIcon=\"caret--left\"\n\t\t\t\t\t\t\tsize=\"16\"\n\t\t\t\t\t\t\tstyle=\"display: inherit\"\n\t\t\t\t\t\t\tclass=\"bx--btn__icon\">\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t</li>\n\t\t\t\t<ibm-pagination-nav-item\n\t\t\t\t\t*ngIf=\"this.numOfItemsToShow >= 5 || (this.numOfItemsToShow <= 4 && currentPage <= 1)\"\n\t\t\t\t\tpage=\"1\"\n\t\t\t\t\t(click)=\"currentPage = 1\"\n\t\t\t\t\t[isActive]=\"currentPage == 1\">\n\t\t\t\t</ibm-pagination-nav-item>\n\t\t\t\t<ibm-pagination-overflow\n\t\t\t\t\t*ngIf=\"frontCuts\"\n\t\t\t\t\t[count]=\"frontCuts\"\n\t\t\t\t\t[fromIndex]=\"startOffset\"\n\t\t\t\t\t(change)=\"handleOverflowSelection($event)\">\n\t\t\t\t</ibm-pagination-overflow>\n\t\t\t\t<ibm-pagination-nav-item\n\t\t\t\t\t*ngFor=\"let page of getPages();\"\n\t\t\t\t\t[page]=\"page\"\n\t\t\t\t\t(click)=\"currentPage = page\"\n\t\t\t\t\t[isActive]=\"currentPage == page\">\n\t\t\t\t</ibm-pagination-nav-item>\n\t\t\t\t<ibm-pagination-overflow\n\t\t\t\t\t*ngIf=\"backCuts\"\n\t\t\t\t\t[count]=\"backCuts\"\n\t\t\t\t\t[fromIndex]=\"totalNumbersArray.length - backCuts - 1\"\n\t\t\t\t\t(change)=\"handleOverflowSelection($event)\">\n\t\t\t\t</ibm-pagination-overflow>\n\t\t\t\t<ibm-pagination-nav-item\n\t\t\t\t\t*ngIf=\"totalDataLength > 1\"\n\t\t\t\t\t[page]=\"totalNumbersArray.length\"\n\t\t\t\t\t(click)=\"currentPage = totalNumbersArray.length\"\n\t\t\t\t\t[isActive]=\"currentPage == totalNumbersArray.length\">\n\t\t\t\t</ibm-pagination-nav-item>\n\t\t\t\t<li class=\"bx--pagination-nav__list-item\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"bx--btn bx--btn--ghost bx--pagination-nav-next\n\t\t\t\t\t\tbx--btn--icon-only bx--tooltip__trigger bx--tooltip--a11y bx--tooltip--bottom bx--tooltip--align-center\"\n\t\t\t\t\t\t[disabled]=\"rightArrowDisabled\"\n\t\t\t\t\t\t(click)=\"jumpToNext()\">\n\t\t\t\t\t\t<span class=\"bx--assistive-text\">{{nextItemText.subject | async}}</span>\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\tibmIcon=\"caret--right\"\n\t\t\t\t\t\t\tsize=\"16\"\n\t\t\t\t\t\t\tstyle=\"display: inherit\"\n\t\t\t\t\t\t\tclass=\"bx--btn__icon\">\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n\t"
                }] }
    ];
    /** @nocollapse */
    PaginationNav.ctorParameters = function () { return [
        { type: I18n },
        { type: ExperimentalService }
    ]; };
    PaginationNav.propDecorators = {
        model: [{ type: Input }],
        disabled: [{ type: Input }],
        numOfItemsToShow: [{ type: Input }],
        translations: [{ type: Input }],
        selectPage: [{ type: Output }]
    };
    return PaginationNav;
}());
export { PaginationNav };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFnaW5hdGlvbi1uYXYuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vY2FyYm9uLWNvbXBvbmVudHMtYW5ndWxhci9wYWdpbmF0aW9uLyIsInNvdXJjZXMiOlsicGFnaW5hdGlvbi1uYXYvcGFnaW5hdGlvbi1uYXYuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUM1RCxPQUFPLEVBQ04sU0FBUyxFQUNULEtBQUssRUFDTCxNQUFNLEVBQ04sWUFBWSxFQUNaLE1BQU0sZUFBZSxDQUFDO0FBRXZCLE9BQU8sRUFBRSxJQUFJLEVBQWUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUNuRSxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSx3Q0FBd0MsQ0FBQztBQUM3RSxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0saUNBQWlDLENBQUM7QUFDeEQsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBT3pEOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQXVCRztBQUNIO0lBMEpDLHVCQUFzQixJQUFVLEVBQVksWUFBaUM7UUFBdkQsU0FBSSxHQUFKLElBQUksQ0FBTTtRQUFZLGlCQUFZLEdBQVosWUFBWSxDQUFxQjtRQTdFN0U7O1dBRUc7UUFDTSxhQUFRLEdBQUcsS0FBSyxDQUFDO1FBQzFCOztXQUVHO1FBQ00scUJBQWdCLEdBQUcsQ0FBQyxDQUFDO1FBa0I5Qjs7Ozs7V0FLRztRQUNPLGVBQVUsR0FBRyxJQUFJLFlBQVksRUFBVSxDQUFDO1FBMkNsRCxpQkFBWSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLGlCQUFpQixDQUFDLENBQUM7UUFDM0QscUJBQWdCLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMscUJBQXFCLENBQUMsQ0FBQztRQUdsRSxhQUFhLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztJQUNuQyxDQUFDO0lB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SSxDQUFDLEVBQUU7WUFDcEIsV0FBVyxJQUFJLFVBQVUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDOUQsVUFBVSxHQUFHLENBQUMsQ0FBQztTQUNmO1FBQ0QsT0FBTztZQUNOLEtBQUssRUFBRSxXQUFXO1lBQ2xCLElBQUksRUFBRSxVQUFVO1NBQ2hCLENBQUM7SUFDSCxDQUFDO0lBdklNLCtCQUFpQixHQUFHLENBQUMsQ0FBQzs7Z0JBeEU3QixTQUFTLFNBQUM7b0JBQ1YsUUFBUSxFQUFFLG9CQUFvQjtvQkFDOUIsUUFBUSxFQUFFLHFyRkFtRVQ7aUJBQ0Q7Ozs7Z0JBeEdRLElBQUk7Z0JBQ0osbUJBQW1COzs7d0JBNkcxQixLQUFLOzJCQUlMLEtBQUs7bUNBSUwsS0FBSzsrQkFXTCxLQUFLOzZCQWFMLE1BQU07O0lBb0dSLG9CQUFDO0NBQUEsQUFoTkQsSUFnTkM7U0F6SVksYUFBYSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2luYXRpb25Nb2RlbCB9IGZyb20gXCIuLi9wYWdpbmF0aW9uLW1vZGVsLmNsYXNzXCI7XG5pbXBvcnQge1xuXHRDb21wb25lbnQsXG5cdElucHV0LFxuXHRPdXRwdXQsXG5cdEV2ZW50RW1pdHRlclxufSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xuXG5pbXBvcnQgeyBJMThuLCBPdmVycmlkYWJsZSB9IGZyb20gXCJjYXJib24tY29tcG9uZW50cy1hbmd1bGFyL2kxOG5cIjtcbmltcG9ydCB7IEV4cGVyaW1lbnRhbFNlcnZpY2UgfSBmcm9tIFwiY2FyYm9uLWNvbXBvbmVudHMtYW5ndWxhci9leHBlcmltZW50YWxcIjtcbmltcG9ydCB7IG1lcmdlIH0gZnJvbSBcImNhcmJvbi1jb21wb25lbnRzLWFuZ3VsYXIvdXRpbHNcIjtcbmltcG9ydCB7IHJhbmdlIH0gZnJvbSBcImNhcmJvbi1jb21wb25lbnRzLWFuZ3VsYXIvY29tbW9uXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFnaW5hdGlvbk5hdlRyYW5zbGF0aW9ucyB7XG5cdE5FWFQ6IHN0cmluZztcblx0UFJFVklPVVM6IHN0cmluZztcbn1cblxuLyoqXG4gKiBVc2UgcGFnaW5hdGlvbiB3aGVuIHlvdSBoYXZlIG11bHRpcGxlIHBhZ2VzIG9mIGRhdGEgdG8gaGFuZGxlLlxuICpcbiAqIFtTZWUgZGVtb10oLi4vLi4vP3BhdGg9L3N0b3J5L2NvbXBvbmVudHMtcGFnaW5hdGlvbi1uYXYtLWJhc2ljKVxuICpcbiAqIGBgYGh0bWxcbiAqIDxpYm0tcGFnaW5hdGlvbi1uYXYgW21vZGVsXT1cIm1vZGVsXCIgKHNlbGVjdFBhZ2UpPVwic2VsZWN0UGFnZSgkZXZlbnQpXCI+PC9pYm0tcGFnaW5hdGlvbi1uYXY+XG4gKiBgYGBcbiAqXG4gKiBJbiB5b3VyIGBzZWxlY3RQYWdlKClgIG1ldGhvZCBzZXQgdGhlIGBtb2RlbC5jdXJyZW50UGFnZWAgdG8gc2VsZWN0ZWQgcGFnZSwgX2FmdGVyX1xuICogeW91IGxvYWQgdGhlIHBhZ2UuXG4gKlxuICogYGBgdHlwZXNjcmlwdFxuICogc2VsZWN0UGFnZShwYWdlKSB7XG4gKiBcdC8vIC4uLiB5b3VyIGNvZGUgdG8gbG9hZCB0aGUgcGFnZSBnb2VzIGhlcmVcbiAqXG4gKiBcdHRoaXMubW9kZWwuY3VycmVudFBhZ2UgPSBwYWdlO1xuICpcbiAqIFx0Ly8gLi4uIGFueXRoaW5nIHlvdSB3YW50IHRvIGRvIGFmdGVyIHBhZ2Ugc2VsZWN0aW9uIGNoYW5nZXMgZ29lcyBoZXJlXG4gKiB9XG4gKiBgYGBcbiAqXG4gKiA8ZXhhbXBsZS11cmw+Li4vLi4vaWZyYW1lLmh0bWw/aWQ9Y29tcG9uZW50cy1wYWdpbmF0aW9uLW5hdi0tYmFzaWM8L2V4YW1wbGUtdXJsPlxuICovXG5AQ29tcG9uZW50KHtcblx0c2VsZWN0b3I6IFwiaWJtLXBhZ2luYXRpb24tbmF2XCIsXG5cdHRlbXBsYXRlOiBgXG5cdDxkaXY+XG5cdFx0PGRpdiBjbGFzcz1cImJ4LS1wYWdpbmF0aW9uLW5hdlwiPlxuXHRcdFx0PHVsIGNsYXNzPVwiYngtLXBhZ2luYXRpb24tbmF2X19saXN0XCI+XG5cdFx0XHRcdDxsaSBjbGFzcz1cImJ4LS1wYWdpbmF0aW9uLW5hdl9fbGlzdC1pdGVtXCI+XG5cdFx0XHRcdFx0PGJ1dHRvblxuXHRcdFx0XHRcdFx0Y2xhc3M9XCJieC0tYnRuIGJ4LS1idG4tLWdob3N0IGJ4LS1wYWdpbmF0aW9uLW5hdi1wcmV2aW91c1xuXHRcdFx0XHRcdFx0YngtLWJ0bi0taWNvbi1vbmx5IGJ4LS10b29sdGlwX190cmlnZ2VyIGJ4LS10b29sdGlwLS1hMTF5IGJ4LS10b29sdGlwLS1ib3R0b20gYngtLXRvb2x0aXAtLWFsaWduLWNlbnRlclwiXG5cdFx0XHRcdFx0XHRbZGlzYWJsZWRdPVwibGVmdEFycm93RGlzYWJsZWRcIlxuXHRcdFx0XHRcdFx0KGNsaWNrKT1cImp1bXBUb1ByZXZpb3VzKClcIj5cblx0XHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwiYngtLWFzc2lzdGl2ZS10ZXh0XCI+e3twcmV2aW91c0l0ZW1UZXh0LnN1YmplY3QgfCBhc3luY319PC9zcGFuPlxuXHRcdFx0XHRcdFx0PHN2Z1xuXHRcdFx0XHRcdFx0XHRpYm1JY29uPVwiY2FyZXQtLWxlZnRcIlxuXHRcdFx0XHRcdFx0XHRzaXplPVwiMTZcIlxuXHRcdFx0XHRcdFx0XHRzdHlsZT1cImRpc3BsYXk6IGluaGVyaXRcIlxuXHRcdFx0XHRcdFx0XHRjbGFzcz1cImJ4LS1idG5fX2ljb25cIj5cblx0XHRcdFx0XHRcdDwvc3ZnPlxuXHRcdFx0XHRcdDwvYnV0dG9uPlxuXHRcdFx0XHQ8L2xpPlxuXHRcdFx0XHQ8aWJtLXBhZ2luYXRpb24tbmF2LWl0ZW1cblx0XHRcdFx0XHQqbmdJZj1cInRoaXMubnVtT2ZJdGVtc1RvU2hvdyA+PSA1IHx8ICh0aGlzLm51bU9mSXRlbXNUb1Nob3cgPD0gNCAmJiBjdXJyZW50UGFnZSA8PSAxKVwiXG5cdFx0XHRcdFx0cGFnZT1cIjFcIlxuXHRcdFx0XHRcdChjbGljayk9XCJjdXJyZW50UGFnZSA9IDFcIlxuXHRcdFx0XHRcdFtpc0FjdGl2ZV09XCJjdXJyZW50UGFnZSA9PSAxXCI+XG5cdFx0XHRcdDwvaWJtLXBhZ2luYXRpb24tbmF2LWl0ZW0+XG5cdFx0XHRcdDxpYm0tcGFnaW5hdGlvbi1vdmVyZmxvd1xuXHRcdFx0XHRcdCpuZ0lmPVwiZnJvbnRDdXRzXCJcblx0XHRcdFx0XHRbY291bnRdPVwiZnJvbnRDdXRzXCJcblx0XHRcdFx0XHRbZnJvbUluZGV4XT1cInN0YXJ0T2Zmc2V0XCJcblx0XHRcdFx0XHQoY2hhbmdlKT1cImhhbmRsZU92ZXJmbG93U2VsZWN0aW9uKCRldmVudClcIj5cblx0XHRcdFx0PC9pYm0tcGFnaW5hdGlvbi1vdmVyZmxvdz5cblx0XHRcdFx0PGlibS1wYWdpbmF0aW9uLW5hdi1pdGVtXG5cdFx0XHRcdFx0Km5nRm9yPVwibGV0IHBhZ2Ugb2YgZ2V0UGFnZXMoKTtcIlxuXHRcdFx0XHRcdFtwYWdlXT1cInBhZ2VcIlxuXHRcdFx0XHRcdChjbGljayk9XCJjdXJyZW50UGFnZSA9IHBhZ2VcIlxuXHRcdFx0XHRcdFtpc0FjdGl2ZV09XCJjdXJyZW50UGFnZSA9PSBwYWdlXCI+XG5cdFx0XHRcdDwvaWJtLXBhZ2luYXRpb24tbmF2LWl0ZW0+XG5cdFx0XHRcdDxpYm0tcGFnaW5hdGlvbi1vdmVyZmxvd1xuXHRcdFx0XHRcdCpuZ0lmPVwiYmFja0N1dHNcIlxuXHRcdFx0XHRcdFtjb3VudF09XCJiYWNrQ3V0c1wiXG5cdFx0XHRcdFx0W2Zyb21JbmRleF09XCJ0b3RhbE51bWJlcnNBcnJheS5sZW5ndGggLSBiYWNrQ3V0cyAtIDFcIlxuXHRcdFx0XHRcdChjaGFuZ2UpPVwiaGFuZGxlT3ZlcmZsb3dTZWxlY3Rpb24oJGV2ZW50KVwiPlxuXHRcdFx0XHQ8L2libS1wYWdpbmF0aW9uLW92ZXJmbG93PlxuXHRcdFx0XHQ8aWJtLXBhZ2luYXRpb24tbmF2LWl0ZW1cblx0XHRcdFx0XHQqbmdJZj1cInRvdGFsRGF0YUxlbmd0aCA+IDFcIlxuXHRcdFx0XHRcdFtwYWdlXT1cInRvdGFsTnVtYmVyc0FycmF5Lmxlbmd0aFwiXG5cdFx0XHRcdFx0KGNsaWNrKT1cImN1cnJlbnRQYWdlID0gdG90YWxOdW1iZXJzQXJyYXkubGVuZ3RoXCJcblx0XHRcdFx0XHRbaXNBY3RpdmVdPVwiY3VycmVudFBhZ2UgPT0gdG90YWxOdW1iZXJzQXJyYXkubGVuZ3RoXCI+XG5cdFx0XHRcdDwvaWJtLXBhZ2luYXRpb24tbmF2LWl0ZW0+XG5cdFx0XHRcdDxsaSBjbGFzcz1cImJ4LS1wYWdpbmF0aW9uLW5hdl9fbGlzdC1pdGVtXCI+XG5cdFx0XHRcdFx0PGJ1dHRvblxuXHRcdFx0XHRcdFx0Y2xhc3M9XCJieC0tYnRuIGJ4LS1idG4tLWdob3N0IGJ4LS1wYWdpbmF0aW9uLW5hdi1uZXh0XG5cdFx0XHRcdFx0XHRieC0tYnRuLS1pY29uLW9ubHkgYngtLXRvb2x0aXBfX3RyaWdnZXIgYngtLXRvb2x0aXAtLWExMXkgYngtLXRvb2x0aXAtLWJvdHRvbSBieC0tdG9vbHRpcC0tYWxpZ24tY2VudGVyXCJcblx0XHRcdFx0XHRcdFtkaXNhYmxlZF09XCJyaWdodEFycm93RGlzYWJsZWRcIlxuXHRcdFx0XHRcdFx0KGNsaWNrKT1cImp1bXBUb05leHQoKVwiPlxuXHRcdFx0XHRcdFx0PHNwYW4gY2xhc3M9XCJieC0tYXNzaXN0aXZlLXRleHRcIj57e25leHRJdGVtVGV4dC5zdWJqZWN0IHwgYXN5bmN9fTwvc3Bhbj5cblx0XHRcdFx0XHRcdDxzdmdcblx0XHRcdFx0XHRcdFx0aWJtSWNvbj1cImNhcmV0LS1yaWdodFwiXG5cdFx0XHRcdFx0XHRcdHNpemU9XCIxNlwiXG5cdFx0XHRcdFx0XHRcdHN0eWxlPVwiZGlzcGxheTogaW5oZXJpdFwiXG5cdFx0XHRcdFx0XHRcdGNsYXNzPVwiYngtLWJ0bl9faWNvblwiPlxuXHRcdFx0XHRcdFx0PC9zdmc+XG5cdFx0XHRcdFx0PC9idXR0b24+XG5cdFx0XHRcdDwvbGk+XG5cdFx0XHQ8L3VsPlxuXHRcdDwvZGl2PlxuXHQ8L2Rpdj5cblx0YFxufSlcbmV4cG9ydCBjbGFzcyBQYWdpbmF0aW9uTmF2IHtcblx0c3RhdGljIHBhZ2luYXRpb25Db3VudGVyID0gMDtcblx0LyoqXG5cdCAqIGBQYWdpbmF0aW9uTmF2TW9kZWxgIHdpdGggdGhlIGluZm9ybWF0aW9uIGFib3V0IHBhZ2VzIHlvdSdyZSBjb250cm9sbGluZy5cblx0ICovXG5cdEBJbnB1dCgpIG1vZGVsOiBQYWdpbmF0aW9uTW9kZWw7XG5cdC8qKlxuIFx0ICogU2V0IHRvIGB0cnVlYCB0byBkaXNhYmxlIHRoZSBiYWNrd2FyZC9mb3J3YXJkIGJ1dHRvbnMuXG5cdCAqL1xuXHRASW5wdXQoKSBkaXNhYmxlZCA9IGZhbHNlO1xuXHQvKipcblx0ICogTnVtYmVyIG9mIGl0ZW1zIHRvIHNob3cgaW4gcGFnaW5hdGlvbi4gTWluaW11bSBpcyA0LlxuXHQgKi9cblx0QElucHV0KCkgbnVtT2ZJdGVtc1RvU2hvdyA9IDQ7XG5cblx0LyoqXG5cdCAqIEV4cGVjdHMgYW4gb2JqZWN0IHRoYXQgY29udGFpbnMgc29tZSBvciBhbGwgb2Y6XG5cdCAqIGBgYFxuXHQgKiB7XG5cdCAqXHRcdFwiTkVYVFwiOiBcIk5leHRcIixcblx0ICpcdFx0XCJQUkVWSU9VU1wiOiBcIlByZXZpb3VzXCIsXG5cdCAqIH1cblx0ICogYGBgXG5cdCAqL1xuXHRASW5wdXQoKVxuXHRzZXQgdHJhbnNsYXRpb25zICh2YWx1ZTogUGFnaW5hdGlvbk5hdlRyYW5zbGF0aW9ucykge1xuXHRcdGNvbnN0IHZhbHVlV2l0aERlZmF1bHRzID0gbWVyZ2UodGhpcy5pMThuLmdldE11bHRpcGxlKFwiUEFHSU5BVElPTlwiKSwgdmFsdWUpO1xuXHRcdHRoaXMubmV4dEl0ZW1UZXh0Lm92ZXJyaWRlKHZhbHVlV2l0aERlZmF1bHRzLk5FWFQpO1xuXHRcdHRoaXMucHJldmlvdXNJdGVtVGV4dC5vdmVycmlkZSh2YWx1ZVdpdGhEZWZhdWx0cy5QUkVWSU9VUyk7XG5cdH1cblxuXHQvKipcblx0ICogRW1pdHMgdGhlIG5ldyBwYWdlIG51bWJlci5cblx0ICpcblx0ICogWW91IHNob3VsZCB0aWUgaW50byB0aGlzIGFuZCB1cGRhdGUgYG1vZGVsLmN1cnJlbnRQYWdlYCBvbmNlIHRoZSBmcmVzaFxuXHQgKiBkYXRhIGlzIGZpbmFsbHkgbG9hZGVkLlxuXHQgKi9cblx0QE91dHB1dCgpIHNlbGVjdFBhZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPG51bWJlcj4oKTtcblxuXHRnZXQgdG90YWxOdW1iZXJzQXJyYXkoKSB7XG5cdFx0cmV0dXJuIHJhbmdlKHRoaXMudG90YWxEYXRhTGVuZ3RoICsgMSwgMSk7XG5cdH1cblxuXHRnZXQgY3VycmVudFBhZ2UoKSB7XG5cdFx0cmV0dXJuIHRoaXMubW9kZWwuY3VycmVudFBhZ2U7XG5cdH1cblxuXHRzZXQgY3VycmVudFBhZ2UodmFsdWUpIHtcblx0XHR2YWx1ZSA9IE51bWJlcih2YWx1ZSk7XG5cdFx0Ly8gZW1pdHMgdGhlIHZhbHVlIHRvIGFsbG93IHRoZSB1c2VyIHRvIHVwZGF0ZSBjdXJyZW50IHBhZ2Vcblx0XHQvLyBpbiB0aGUgbW9kZWwgb25jZSB0aGUgcGFnZSBpcyBsb2FkZWRcblx0XHR0aGlzLnNlbGVjdFBhZ2UuZW1pdCh2YWx1ZSk7XG5cdH1cblxuXHRnZXQgdG90YWxEYXRhTGVuZ3RoKCkge1xuXHRcdHJldHVybiB0aGlzLm1vZGVsLnRvdGFsRGF0YUxlbmd0aDtcblx0fVxuXG5cdGdldCBzdGFydE9mZnNldCgpIHtcblx0XHRyZXR1cm4gdGhpcy5udW1PZkl0ZW1zVG9TaG93IDw9IDQgJiYgdGhpcy5jdXJyZW50UGFnZSA+IDEgPyAwIDogMTtcblx0fVxuXG5cdGdldCBmcm9udEN1dHMoKSB7XG5cdFx0Y29uc3QgY3V0cyA9IHRoaXMuZ2V0Q3V0cygpO1xuXHRcdHJldHVybiBjdXRzLmZyb250O1xuXHR9XG5cblx0Z2V0IGJhY2tDdXRzKCkge1xuXHRcdGNvbnN0IGN1dHMgPSB0aGlzLmdldEN1dHMoKTtcblx0XHRyZXR1cm4gY3V0cy5iYWNrO1xuXHR9XG5cblx0Z2V0IGxlZnRBcnJvd0Rpc2FibGVkKCkge1xuXHRcdHJldHVybiB0aGlzLmRpc2FibGVkIHx8IHRoaXMuY3VycmVudFBhZ2UgPT09IDE7XG5cdH1cblxuXHRnZXQgcmlnaHRBcnJvd0Rpc2FibGVkKCkge1xuXHRcdHJldHVybiB0aGlzLmRpc2FibGVkIHx8IHRoaXMuY3VycmVudFBhZ2UgPT09IHRoaXMudG90YWxEYXRhTGVuZ3RoO1xuXHR9XG5cblx0bmV4dEl0ZW1UZXh0ID0gdGhpcy5pMThuLmdldE92ZXJyaWRhYmxlKFwiUEFHSU5BVElPTi5ORVhUXCIpO1xuXHRwcmV2aW91c0l0ZW1UZXh0ID0gdGhpcy5pMThuLmdldE92ZXJyaWRhYmxlKFwiUEFHSU5BVElPTi5QUkVWSU9VU1wiKTtcblxuXHRjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgaTE4bjogSTE4biwgcHJvdGVjdGVkIGV4cGVyaW1lbnRhbDogRXhwZXJpbWVudGFsU2VydmljZSkge1xuXHRcdFBhZ2luYXRpb25OYXYucGFnaW5hdGlvbkNvdW50ZXIrKztcblx0fVxuXG5cdGhhbmRsZU92ZXJmbG93U2VsZWN0aW9uKHBhZ2UpIHtcblx0XHRpZiAodHlwZW9mIHBhZ2UgPT09IFwibnVtYmVyXCIpIHtcblx0XHRcdHRoaXMuY3VycmVudFBhZ2UgPSBwYWdlO1xuXHRcdH1cblx0fVxuXG5cdHB1YmxpYyBqdW1wVG9OZXh0KCkge1xuXHRcdHRoaXMuY3VycmVudFBhZ2UgPSB0aGlzLmN1cnJlbnRQYWdlIDwgdGhpcy50b3RhbERhdGFMZW5ndGggPyB0aGlzLmN1cnJlbnRQYWdlICsgMSA6IHRoaXMudG90YWxEYXRhTGVuZ3RoO1xuXHR9XG5cblx0cHVibGljIGp1bXBUb1ByZXZpb3VzKCkge1xuXHRcdHRoaXMuY3VycmVudFBhZ2UgPSB0aGlzLmN1cnJlbnRQYWdlID4gMSA/IHRoaXMuY3VycmVudFBhZ2UgLSAxIDogMTtcblx0fVxuXG5cdHB1YmxpYyBnZXRQYWdlcygpIHtcblx0XHRpZiAodGhpcy50b3RhbERhdGFMZW5ndGggPD0gMSkge1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHRcdGNvbnN0IGN1dHMgPSB0aGlzLmdldEN1dHMoKTtcblx0XHRyZXR1cm4gdGhpcy50b3RhbE51bWJlcnNBcnJheS5zbGljZSh0aGlzLnN0YXJ0T2Zmc2V0ICsgY3V0cy5mcm9udCwgKDEgKyBjdXRzLmJhY2spICogLTEpO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRDdXRzKHNwbGl0UG9pbnQgPSBudWxsKSB7XG5cdFx0Y29uc3QgcGFnZSA9IHRoaXMuY3VycmVudFBhZ2UgLSAxO1xuXHRcdGNvbnN0IHRvdGFsSXRlbXMgPSB0aGlzLnRvdGFsRGF0YUxlbmd0aDtcblx0XHRjb25zdCBpdGVtc1RoYXRGaXQgPSB0aGlzLm51bU9mSXRlbXNUb1Nob3c7XG5cblx0XHRpZiAoaXRlbXNUaGF0Rml0ID49IHRvdGFsSXRlbXMpIHtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGZyb250OiAwLFxuXHRcdFx0XHRiYWNrOiAwXG5cdFx0XHR9O1xuXHRcdH1cblx0XHRjb25zdCBzcGxpdCA9IHNwbGl0UG9pbnQgfHwgTWF0aC5jZWlsKGl0ZW1zVGhhdEZpdCAvIDIpIC0gMTtcblx0XHRsZXQgZnJvbnRIaWRkZW4gPSBwYWdlICsgMSAtIHNwbGl0O1xuXHRcdGxldCBiYWNrSGlkZGVuID0gdG90YWxJdGVtcyAtIHBhZ2UgLSAoaXRlbXNUaGF0Rml0IC0gc3BsaXQpICsgMTtcblxuXHRcdGlmIChmcm9udEhpZGRlbiA8PSAxKSB7XG5cdFx0XHRiYWNrSGlkZGVuIC09IGZyb250SGlkZGVuIDw9IDAgPyBNYXRoLmFicyhmcm9udEhpZGRlbikgKyAxIDogMDtcblx0XHRcdGZyb250SGlkZGVuID0gMDtcblx0XHR9XG5cdFx0aWYgKGJhY2tIaWRkZW4gPD0gMSkge1xuXHRcdFx0ZnJvbnRIaWRkZW4gLT0gYmFja0hpZGRlbiA8PSAwID8gTWF0aC5hYnMoYmFja0hpZGRlbikgKyAxIDogMDtcblx0XHRcdGJhY2tIaWRkZW4gPSAwO1xuXHRcdH1cblx0XHRyZXR1cm4ge1xuXHRcdFx0ZnJvbnQ6IGZyb250SGlkZGVuLFxuXHRcdFx0YmFjazogYmFja0hpZGRlblxuXHRcdH07XG5cdH1cbn1cbiJdfQ==